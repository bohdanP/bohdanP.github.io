<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<script src="https://rawgit.com/kangax/fabric.js/master/dist/fabric.js"></script>
	<script scr="fabric.min.js"></script>


	<style>

		#colors_sketch
		{
			margin: 0;
			padding: 0;
			position: absolute;
			top: 0px;
			left: 0px;
			
			background-color: red;
			-webkit-clip-path:url(#svgPath);
			clip-path:url(#svgPath);
		}
		#colors_sketch1
		{
			margin: 0;
			padding: 0;
			position: absolute;
			top: 8px;
			left: 8px;
			background-image: url(origin_outline.svg);
		}
		.clipping
		{
			-webkit-clip-path:url(#svgPath);
			clip-path:url(#svgPath);
		}
	</style>




</head>
<body>





	<div class="wrapper">
		<canvas id="colors_sketch1" width="2048" height="2048"></canvas>
		<canvas id="colors_sketch" class="clipping" width="2048" height="2048"></canvas>
	</div>	

	<div style="display: inline-block; margin-left: 10px">
		<button id="drawing-mode" class="btn btn-info">Cancel drawing mode</button><br>
		<button id="clear-canvas" class="btn btn-info">Clear</button><br>

		<div id="drawing-mode-options">
			<label for="drawing-mode-selector">Mode:</label>
			<select id="drawing-mode-selector">
				<option>Pencil</option>
				<option>Circle</option>
				<option>Spray</option>
				<option>Pattern</option>

				<option>hline</option>
				<option>vline</option>
				<option>square</option>
				<option>diamond</option>
				<option>texture</option>
			</select><br>

			<label for="drawing-line-width">Line width:</label>
			<span class="info">30</span><input type="range" value="30" min="0" max="150" id="drawing-line-width"><br>

			<label for="drawing-color">Line color:</label>
			<input type="color" value="#005E7A" id="drawing-color"><br>

			<label for="drawing-shadow-color">Shadow color:</label>
			<input type="color" value="#005E7A" id="drawing-shadow-color"><br>

			<label for="drawing-shadow-width">Shadow width:</label>
			<span class="info">0</span><input type="range" value="0" min="0" max="50" id="drawing-shadow-width"><br>

			<label for="drawing-shadow-offset">Shadow offset:</label>
			<span class="info">0</span><input type="range" value="0" min="0" max="50" id="drawing-shadow-offset"><br>
		</div>
	</div>


	
	<svg height="0" width="0">
		<defs>
			<clipPath id="svgPath">

				<path fill="#FFFFFF" d="M1551.33,714.803c-2.782-0.011-5.659-0.022-8.429,0.06c-4.324,0.16-8.67,0.591-13.013,1.259
				c1.553,1.733,3.017,3.495,4.353,5.276c2.252,3.104,4.309,6.375,6.132,9.749c2.11,3.96,3.618,7.287,4.752,10.48
				c1.29,3.601,2.355,7.314,3.166,11.03c0.88,4.085,1.431,7.797,1.686,11.354c0.256,3.855,0.257,7.734,0.006,11.539
				c-0.255,3.841-0.773,7.685-1.541,11.424c-0.246,1.203-0.532,2.408-0.834,3.607c1.435-0.734,2.859-1.471,4.272-2.212
				c22.516-11.807,43.173-24.879,61.399-38.854c17.66-13.583,36.787-30.684,44.73-54.508c1.838-5.524,2.825-11.623,2.936-18.125
				c0.049-3.171-0.127-6.413-0.521-9.63c-0.436-3.513-1.067-6.729-1.877-9.556c-1.796-6.436-4.439-12.43-7.863-17.83
				c-3.472-5.384-7.814-10.042-12.899-13.837c-0.422-0.213-0.843-0.429-1.27-0.632c-1.406-0.664-2.694-1.215-3.935-1.685
				c-1.314-0.479-2.68-0.922-4.036-1.306c-5.442-1.547-11.009-2.277-16.533-2.173c-5.417,0.08-10.74,1.041-15.83,2.859
				c-5.087,1.811-9.686,4.4-13.672,7.696c-7.76,6.42-13.4,15.849-15.881,26.549c-1.201,5.244-1.647,10.691-1.291,15.749
				c0.36,5.307,1.574,10.417,3.607,15.196c2.515,6.084,6.378,11.577,11.183,15.904c4.904,4.611,10.691,7.841,16.768,9.37
				c2.648,0.646,5.272,1.002,7.816,1.062l-0.32-0.456c4.321-3.039,7.453-7.742,8.817-13.243c1.345-5.501,0.741-11.243-1.7-16.159
				c-3.232-6.66-10.162-11.74-18.093-13.275l-3.249-0.628l2.067-2.584c3.675-4.596,9.45-7.747,15.844-8.645
				c6.633-0.919,13.337,0.591,18.384,4.143c6.036,4.271,10.358,11.167,11.863,18.92c1.399,7.741-0.031,15.569-3.921,21.503
				c-3.814,5.828-9.723,10.172-17.085,12.562c-3.425,1.112-7.009,1.735-10.651,1.851c-3.472,0.121-7.08-0.275-10.735-1.167
				c-5.866-1.476-11.468-4.362-16.358-8.408l0.852,2.151c-5.198,2.059-11.182,3.171-18.828,3.501
				C1558.167,714.829,1554.692,714.815,1551.33,714.803z"/>
				<path fill="#FFFFFF" d="M302.65,1811.404c7.221-3.069,14.854-5.096,22.234-7.054c3.865-1.026,7.861-2.086,11.723-3.279
				c13.426-4.146,22.647-9.415,28.971-16.546c-0.527-2.467-0.973-4.944-1.329-7.428c-3.277-22.858-0.085-46.438,9.232-68.246
				c-4.345-12.686-10.421-29.05-19.114-44.529c-8.54-15.207-22.422-35.799-40.062-47.542c-9.942-6.618-20.625-9.974-31.753-9.974
				c-6.771,0-13.902,1.237-21.195,3.677c-17.152,5.738-33.198,19.117-42.923,35.79c-1.305,2.241-2.507,4.497-3.57,6.702
				c-0.379,0.789-0.743,1.587-1.107,2.386l-0.178,0.392c-0.171,0.373-0.308,0.667-0.418,0.897c-0.081,0.255-0.191,0.587-0.341,1.021
				c-1.882,5.469-3.283,10.759-4.28,16.171c-0.029,0.167-0.095,0.702-0.142,1.07c-0.137,1.358-0.237,2.632-0.301,3.848
				c-0.127,2.428-0.141,4.891-0.042,7.32c0.041,0.978,0.1,1.956,0.175,2.931c0.009,0.09,0.054,0.447,0.106,0.873
				c0.136,1.097,0.206,1.678,0.232,1.98c0.414,2.451,0.874,4.656,1.406,6.736c0.605,2.361,1.324,4.718,2.135,7.005
				c0.066,0.187,0.225,0.596,0.379,0.996c0.147,0.382,0.292,0.757,0.367,0.963l0.082,0.185c0.225,0.51,0.45,1.019,0.688,1.521
				c1.034,2.187,2.179,4.341,3.404,6.402c0.753,1.268,1.534,2.499,2.319,3.661c0.025,0.033,0.197,0.259,0.409,0.539
				c0.733,0.967,1.081,1.426,1.263,1.692c9.462,11.391,21.808,18.092,34.775,18.872c0.855,0.051,1.727,0.077,2.588,0.077
				c14.746,0,32.252-7.802,38.12-25.23c0.723-2.097,1.33-4.237,1.81-6.375c0.171-0.761,0.314-1.524,0.458-2.288l0.202-1.064
				c0-0.042,0-0.086,0-0.134c0.002-1.021,0.054-2.046,0.104-3.036c0.064-1.272,0.125-2.476,0.088-3.682
				c-0.022-0.747-0.074-1.489-0.125-2.232l-0.072-1.092c-0.007-0.111-0.012-0.213-0.017-0.307c-0.038-0.134-0.082-0.292-0.132-0.485
				l-0.137-0.535c-0.52-2.033-1.01-3.953-1.593-5.892c-0.124-0.273-0.238-0.575-0.357-0.893c-0.196-0.521-0.415-1.111-0.513-1.325
				c-0.569-1.144-1.189-2.268-1.838-3.33c-0.399-0.465-0.86-1.175-1.544-2.233l-0.404-0.5c-0.563-0.646-1.209-1.344-1.875-2.018
				c-0.475-0.479-0.965-0.935-1.457-1.392l-0.967-0.875c-0.499-0.362-1.006-0.714-1.525-1.045c-0.533-0.349-1.062-0.651-1.591-0.955
				c-0.515-0.296-1.03-0.593-1.532-0.911c-0.248-0.157-0.446-0.288-0.605-0.398c-0.156-0.044-0.34-0.101-0.56-0.172
				c-0.589-0.191-1.175-0.371-1.765-0.547c1.02,0.704,1.968,1.521,2.85,2.451c6.232,6.583,8.313,17.232,5.176,26.5
				c-4.06,11.994-14.643,19.744-26.961,19.744c-6.831,0-13.388-2.334-18.962-6.75c-12.121-9.603-16.977-24.262-13.325-40.219
				c4.164-18.188,18.236-32.931,35.017-36.684c3.534-0.79,7.157-1.19,10.767-1.19c27.226,0,52.416,22.532,57.348,51.297
				c5.137,29.973-7.1,60.083-31.174,76.708c-11.974,8.269-26.585,12.639-42.253,12.639c-5.327,0-10.667-0.516-15.922-1.534
				c1.358,3.525,2.724,6.755,4.142,9.8c6.688,14.359,15.106,28.341,25.019,41.556c1.626,2.168,3.302,4.315,5.001,6.453
				C283.421,1821.438,294.257,1814.974,302.65,1811.404z"/>
				<path fill="#FFFFFF" d="M1272.927,1321.437L1272.927,1321.437c-0.987,0.988-2.161,1.754-2.961,2.241
				c-1.172,0.698-2.259,1.181-3.34,1.485c-1.237,0.384-2.558,0.586-3.876,0.586c-3.178,0-6.224-1.145-8.808-3.309
				c-1.566-1.296-2.965-2.93-4.146-4.849c-1.067-1.758-1.907-3.578-2.436-5.275c-0.935-2.901-1.18-5.514-0.736-7.908l-0.182-0.022
				c0.751-6.21,0.705-15.204-3.778-22.788c-4.095-6.925-11.399-11.002-18.2-10.143c-7.265,0.918-12.618,6.997-15.163,10.539
				c-11.224,15.626-10.603,39.604,1.415,54.591c9.877,12.32,26.49,19.101,44.426,18.169c14.755-0.774,30.552-6.592,46.951-17.291
				c22.266-14.523,41.039-34.528,54.391-57.899c2.604-11.092,4.122-22.753,4.491-34.826l0.09-2.943l2.703,1.169
				c23.901,10.34,43.957,28.303,56.807,50.794c35.953-58.94,43.459-133.945,19.492-196.61c-14.292-37.367-39.459-69.857-71.049-93.856
				l-2.889-1.353c0.094-0.2,0.192-0.396,0.287-0.596c-27.186-20.03-58.936-33.837-92.506-39.188l-5.381-0.858l4.657-2.827
				c43.883-26.633,96.939-38.603,147.384-33.575c-40.283-26.97-88.417-40.363-136.515-37.826
				c-49.853,2.637-98.047,22.325-136.089,55.503c1.083,3.257,2.294,6.49,3.487,9.647c2.206,5.833,4.466,11.838,5.907,18.079
				c4.322-2.667,8.775-5.418,13.08-8.214c12.919-8.394,29.064-20.13,39.33-36.525l2.067-3.302l1.479,3.604
				c13.093,31.925,12.393,69.023-1.703,100.129c11.189,0.559,22.272,3.101,32.534,7.683c9.662,4.313,18.579,10.3,27.201,16.088
				c2.356,1.582,4.712,3.163,7.083,4.712c10.109,6.605,22.196,13.677,35.192,16.043c4.809,0.877,9.627,1.029,14.32,0.452l4.916-0.604
				l-3.118,3.848c-13.863,17.108-31.935,30.265-51.929,38.039c10.606,3.766,19.446,11.129,28.032,18.303
				c14.04,11.729,27.301,22.81,47.182,18.067l6.963-1.661l-5.094,5.029c-4.997,4.934-10.08,9.26-15.241,12.979
				c25.606,8.851,46.664,32.167,53.258,59.57l1.01,4.193l-3.854-1.939c-4.684-2.356-10.333-3.759-15.907-3.948
				c-8.511-0.294-17.141,1.574-25.487,3.377c-3.438,0.743-6.994,1.512-10.521,2.127c-5.022,0.878-9.671,1.318-13.967,1.318
				c-7.184,0-13.373-1.244-18.687-3.721C1312.366,1259.352,1299.722,1296.622,1272.927,1321.437z"/>
				<use xlink:href="#ww" />
				<use xlink:href="#star" />
				<path fill="#FFFFFF" d="M492.163,1917.86c4.394-6.939,9.168-15.86,8.438-24.668c-22.476-1.024-44.358-6.999-63.841-17.457
				c-3.522,9.371-9.999,17.185-16.277,24.754c-7.103,8.564-13.81,16.669-16.572,26.784c10.329,3.858,20.829,6.945,31.683,9.304
				c14.359,3.119,29.262,4.981,44.429,5.604c1.667-7.962,6.151-14.971,10.515-21.776
				C491.083,1919.555,491.627,1918.707,492.163,1917.86z"></path>
			</clipPath>
		</defs>
		<polygon id="star" points="48 6 65 30 92 37 75 60 75 88 48 80 22 88 22 60 6 37 32 30" style="fill:none;stroke:#fadf0b;stroke-width:6" />
		<path id="ww" style="fill:none;stroke:green;stroke-width:60" d="M1103.262,297.757c25.908-1.49,50.271-12.559,72.741-24.302c4.249-2.22,8.56-4.53,12.729-6.764   c18.65-9.992,37.935-20.324,58.522-26.394c28.527-8.41,55.454-6.696,76.028,4.791c7.805-6.536,17.566-10.6,27.521-10.6   c6.39,0,12.277,1.712,17.501,5.088c12.261,7.926,14.789,26.262,10.942,39.492c-3.797,13.059-12.838,20.91-24.187,21   c-7.555,0-12.05-8.873-12.297-15.005c-0.137-3.435,0.841-7.032,2.828-10.407c0.504-0.855,2.089-2.501,5.686-6.109   c0.785-0.788,1.701-1.706,2.29-2.317c-0.364-0.792-1.013-1.142-2.051-1.142c-3.135,0-8.012,3.265-9.366,7.32   c-3.306,9.893-1.31,20.639,5.62,30.258c8.15,11.314,21.649,18.625,34.391,18.623c3.219,0,6.366-0.458,9.356-1.358   c11.188-3.37,20.817-11.732,27.114-23.546c7.694-14.439,9.516-32.056,4.871-47.126c-7.877-25.557-31.659-46.716-62.066-55.22   c-12.193-3.41-25.419-5.068-40.43-5.068c-16.525,0-33.11,2.073-45.712,3.879c-5.176,0.741-10.446,1.549-15.543,2.33   c-20.22,3.099-41.129,6.303-61.873,6.303c-3.408,0-6.783-0.087-10.031-0.259c-10.984-0.581-22.078-2.349-32.972-5.255   c-40.749-10.873-76.195-36.2-105.355-75.276c-6.649-8.911-12.691-18.484-18.046-28.548v119.497   c14.992,22.306,33.345,42.832,51.117,62.693C1089.43,281.979,1096.437,289.814,1103.262,297.757z"/>

	</svg>






	<script>
		(function() {
			var $ = function(id){return document.getElementById(id)};

			var canvas = this.__canvas = new fabric.Canvas('colors_sketch', {
				isDrawingMode: true
			});

			fabric.Object.prototype.transparentCorners = true;

			var drawingModeEl = $('drawing-mode'),
			drawingOptionsEl = $('drawing-mode-options'),
			drawingColorEl = $('drawing-color'),
			drawingShadowColorEl = $('drawing-shadow-color'),
			drawingLineWidthEl = $('drawing-line-width'),
			drawingShadowWidth = $('drawing-shadow-width'),
			drawingShadowOffset = $('drawing-shadow-offset'),
			clearEl = $('clear-canvas');

			clearEl.onclick = function() { canvas.clear() };

			drawingModeEl.onclick = function() {
				canvas.isDrawingMode = !canvas.isDrawingMode;
				if (canvas.isDrawingMode) {
					drawingModeEl.innerHTML = 'Cancel drawing mode';
					drawingOptionsEl.style.display = '';
				}
				else {
					drawingModeEl.innerHTML = 'Enter drawing mode';
					drawingOptionsEl.style.display = 'none';
				}
			};

			if (fabric.PatternBrush) {
				var vLinePatternBrush = new fabric.PatternBrush(canvas);
				vLinePatternBrush.getPatternSrc = function() {

					var patternCanvas = fabric.document.createElement('canvas');
					patternCanvas.width = patternCanvas.height = 10;
					var ctx = patternCanvas.getContext('2d');

					ctx.strokeStyle = this.color;
					ctx.lineWidth = 5;
					ctx.beginPath();
					ctx.moveTo(0, 5);
					ctx.lineTo(10, 5);
					ctx.closePath();
					ctx.stroke();

					return patternCanvas;
				};

				var hLinePatternBrush = new fabric.PatternBrush(canvas);
				hLinePatternBrush.getPatternSrc = function() {

					var patternCanvas = fabric.document.createElement('canvas');
					patternCanvas.width = patternCanvas.height = 10;
					var ctx = patternCanvas.getContext('2d');

					ctx.strokeStyle = this.color;
					ctx.lineWidth = 5;
					ctx.beginPath();
					ctx.moveTo(5, 0);
					ctx.lineTo(5, 10);
					ctx.closePath();
					ctx.stroke();

					return patternCanvas;
				};

				var squarePatternBrush = new fabric.PatternBrush(canvas);
				squarePatternBrush.getPatternSrc = function() {

					var squareWidth = 10, squareDistance = 2;

					var patternCanvas = fabric.document.createElement('canvas');
					patternCanvas.width = patternCanvas.height = squareWidth + squareDistance;
					var ctx = patternCanvas.getContext('2d');

					ctx.fillStyle = this.color;
					ctx.fillRect(0, 0, squareWidth, squareWidth);

					return patternCanvas;
				};

				var diamondPatternBrush = new fabric.PatternBrush(canvas);
				diamondPatternBrush.getPatternSrc = function() {

					var squareWidth = 10, squareDistance = 5;
					var patternCanvas = fabric.document.createElement('canvas');
					var rect = new fabric.Rect({
						width: squareWidth,
						height: squareWidth,
						angle: 45,
						fill: this.color
					});

					var canvasWidth = rect.getBoundingRectWidth();

					patternCanvas.width = patternCanvas.height = canvasWidth + squareDistance;
					rect.set({ left: canvasWidth / 2, top: canvasWidth / 2 });

					var ctx = patternCanvas.getContext('2d');
					rect.render(ctx);

					return patternCanvas;
				};

				var img = new Image();
				img.src = '../assets/honey_im_subtle.png';

				var texturePatternBrush = new fabric.PatternBrush(canvas);
				texturePatternBrush.source = img;
			}

			$('drawing-mode-selector').onchange = function() {

				if (this.value === 'hline') {
					canvas.freeDrawingBrush = vLinePatternBrush;
				}
				else if (this.value === 'vline') {
					canvas.freeDrawingBrush = hLinePatternBrush;
				}
				else if (this.value === 'square') {
					canvas.freeDrawingBrush = squarePatternBrush;
				}
				else if (this.value === 'diamond') {
					canvas.freeDrawingBrush = diamondPatternBrush;
				}
				else if (this.value === 'texture') {
					canvas.freeDrawingBrush = texturePatternBrush;
				}
				else {
					canvas.freeDrawingBrush = new fabric[this.value + 'Brush'](canvas);
				}

				if (canvas.freeDrawingBrush) {
					canvas.freeDrawingBrush.color = drawingColorEl.value;
					canvas.freeDrawingBrush.width = parseInt(drawingLineWidthEl.value, 10) || 1;
					canvas.freeDrawingBrush.shadowBlur = parseInt(drawingShadowWidth.value, 10) || 0;
				}
			};

			drawingColorEl.onchange = function() {
				canvas.freeDrawingBrush.color = this.value;
			};
			drawingShadowColorEl.onchange = function() {
				canvas.freeDrawingBrush.shadowColor = this.value;
			};
			drawingLineWidthEl.onchange = function() {
				canvas.freeDrawingBrush.width = parseInt(this.value, 10) || 1;
				this.previousSibling.innerHTML = this.value;
			};
			drawingShadowWidth.onchange = function() {
				canvas.freeDrawingBrush.shadowBlur = parseInt(this.value, 10) || 0;
				this.previousSibling.innerHTML = this.value;
			};
			drawingShadowOffset.onchange = function() {
				canvas.freeDrawingBrush.shadowOffsetX =
				canvas.freeDrawingBrush.shadowOffsetY = parseInt(this.value, 10) || 0;
				this.previousSibling.innerHTML = this.value;
			};

			if (canvas.freeDrawingBrush) {
				canvas.freeDrawingBrush.color = drawingColorEl.value;
				canvas.freeDrawingBrush.width = parseInt(drawingLineWidthEl.value, 10) || 1;
				canvas.freeDrawingBrush.shadowBlur = 0;
			}
		})();
	</script>



</body>
</html>